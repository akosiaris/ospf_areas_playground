version: "3.6"
services:
  backbone1:
    image: pierky/bird:1.6.6
    cap_add:
      - NET_ADMIN
    volumes:
      - type: bind
        source: ./backbone1
        target: /etc/bird
    networks:
      - backbone1-backbone2
      - backbone6-backbone1
      - deadendnormal1-backbone1
  backbone2:
    image: pierky/bird:1.6.6
    cap_add:
      - NET_ADMIN
    volumes:
      - type: bind
        source: ./backbone2
        target: /etc/bird
    networks:
      - backbone2-backbone3
      - backbone1-backbone2
      - asbrnormal1-backbone2
  backbone3:
    image: pierky/bird:1.6.6
    cap_add:
      - NET_ADMIN
    volumes:
      - type: bind
        source: ./backbone3
        target: /etc/bird
    networks:
      - backbone3-backbone4
      - backbone2-backbone3
  backbone4:
    image: pierky/bird:1.6.6
    cap_add:
      - NET_ADMIN
    volumes:
      - type: bind
        source: ./backbone4
        target: /etc/bird
    networks:
      - backbone4-backbone5
      - backbone3-backbone4
  backbone5:
    image: pierky/bird:1.6.6
    cap_add:
      - NET_ADMIN
    volumes:
      - type: bind
        source: ./backbone5
        target: /etc/bird
    networks:
      - backbone5-backbone6
      - backbone4-backbone5
  backbone6:
    cap_add:
      - NET_ADMIN
    image: pierky/bird:1.6.6
    volumes:
      - type: bind
        source: ./backbone6
        target: /etc/bird
    networks:
      - backbone6-backbone1
      - backbone5-backbone6

  # Deadend normal area section
  deadendnormal1:
    cap_add:
      - NET_ADMIN
    image: pierky/bird:1.6.6
    volumes:
      - type: bind
        source: ./deadendnormal1
        target: /etc/bird
    networks:
      - deadendnormal1-backbone1
      - deadendnormal1-deadendnormal2
  deadendnormal2:
    cap_add:
      - NET_ADMIN
    image: pierky/bird:1.6.6
    volumes:
      - type: bind
        source: ./deadendnormal2
        target: /etc/bird
    networks:
      - deadendnormal1-deadendnormal2

  # normal area with an ASBR section
  asbrnormal1:
    cap_add:
      - NET_ADMIN
    image: pierky/bird:1.6.6
    volumes:
      - type: bind
        source: ./asbrnormal1
        target: /etc/bird
    networks:
      - asbrnormal1-backbone2
      - asbrnormal1-asbrnormal2
  asbrnormal2:
    cap_add:
      - NET_ADMIN
    image: pierky/bird:1.6.6
    volumes:
      - type: bind
        source: ./asbrnormal2
        target: /etc/bird
    networks:
      - asbrnormal1-asbrnormal2

networks:
  backbone1-backbone2:
  backbone2-backbone3:
  backbone3-backbone4:
  backbone4-backbone5:
  backbone5-backbone6:
  backbone6-backbone1:

  # Links for backbone to deadend normal area
  deadendnormal1-backbone1:
  deadendnormal1-deadendnormal2:

  # Links for backbone to ASBR connected normal area
  asbrnormal1-backbone2:
  asbrnormal1-asbrnormal2:
